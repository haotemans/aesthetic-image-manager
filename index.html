<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äºŒæ¬¡å…ƒç¾å­¦å›¾ç‰‡è®­ç»ƒé›†ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
            --gray-light: #e9ecef;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #e0e0ff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* å¤´éƒ¨æ ·å¼ */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(67, 97, 238, 0.3);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            font-size: 2.8rem;
            background: linear-gradient(90deg, #4361ee, #4cc9f0);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .subtitle {
            color: #a0b0ff;
            font-size: 1.2rem;
            max-width: 900px;
            margin: 0 auto;
            opacity: 0.9;
        }
        
        /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-section {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(67, 97, 238, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .section-title {
            font-size: 1.8rem;
            color: #4cc9f0;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(76, 201, 240, 0.3);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .upload-areas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .upload-area {
            border: 3px dashed #4361ee;
            border-radius: 15px;
            padding: 40px 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(30, 60, 150, 0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 280px;
        }
        
        .upload-area:hover {
            background: rgba(30, 60, 150, 0.25);
            border-color: #4cc9f0;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.2);
        }
        
        .upload-area i {
            font-size: 4rem;
            color: #4361ee;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .upload-area:hover i {
            color: #4cc9f0;
            transform: scale(1.1);
        }
        
        .upload-area h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #a0c0ff;
        }
        
        .upload-area p {
            color: #8899dd;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }
        
        .file-input {
            display: none;
        }
        
        .upload-btn {
            background: linear-gradient(90deg, #4361ee, #3f37c9);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
            box-shadow: 0 6px 15px rgba(67, 97, 238, 0.3);
        }
        
        .upload-btn:hover:not(:disabled) {
            background: linear-gradient(90deg, #4cc9f0, #4361ee);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.4);
        }
        
        .upload-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .upload-status {
            margin-top: 25px;
            padding: 20px;
            border-radius: 12px;
            background: rgba(30, 60, 150, 0.2);
            border-left: 5px solid #4361ee;
        }
        
        /* ç­›é€‰å™¨åŒºåŸŸæ ·å¼ */
        .filter-section {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(67, 97, 238, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .dimension-filters {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .dimension-filter {
            background: rgba(20, 40, 100, 0.3);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #4361ee;
            transition: all 0.3s;
        }
        
        .dimension-filter:hover {
            background: rgba(20, 40, 100, 0.5);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .dimension-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: #a0c0ff;
        }
        
        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .filter-btn {
            padding: 8px 16px;
            background: rgba(50, 80, 180, 0.3);
            border: 1px solid rgba(100, 150, 255, 0.3);
            border-radius: 8px;
            color: #c0d0ff;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            flex: 1;
            min-width: 60px;
            text-align: center;
        }
        
        .filter-btn:hover {
            background: rgba(70, 110, 220, 0.4);
            transform: translateY(-2px);
        }
        
        .filter-btn.active {
            background: linear-gradient(90deg, #4361ee, #4cc9f0);
            color: white;
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.4);
            border-color: #4cc9f0;
        }
        
        .filter-btn.poor { color: #ff6b6b; border-color: #ff6b6b; }
        .filter-btn.fair { color: #ffd166; border-color: #ffd166; }
        .filter-btn.good { color: #06d6a0; border-color: #06d6a0; }
        .filter-btn.excellent { color: #118ab2; border-color: #118ab2; }
        .filter-btn.perfect { color: #9d4edd; border-color: #9d4edd; }
        
        .current-filter-info {
            background: rgba(20, 40, 100, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .filter-info-item {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-info-label {
            color: #8899dd;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .filter-info-value {
            font-size: 1.3rem;
            color: #4cc9f0;
            font-weight: bold;
        }
        
        /* ç»Ÿè®¡åŒºåŸŸæ ·å¼ */
        .stats-section {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(67, 97, 238, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-item {
            background: rgba(20, 40, 100, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            border-top: 4px solid #4361ee;
        }
        
        .stat-item:hover {
            background: rgba(20, 40, 100, 0.5);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .stat-count {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4cc9f0;
            margin-bottom: 10px;
        }
        
        .stat-range {
            font-size: 1rem;
            color: #a0c0ff;
            margin-bottom: 8px;
        }
        
        .stat-percentage {
            font-size: 0.9rem;
            color: #8899dd;
        }
        
        /* å›¾ç‰‡ç”»å»Šæ ·å¼ */
        .gallery-section {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(67, 97, 238, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .gallery-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .sort-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        select {
            background: rgba(20, 40, 100, 0.5);
            border: 1px solid rgba(100, 150, 255, 0.3);
            border-radius: 10px;
            padding: 12px 20px;
            color: #e0e0ff;
            font-size: 1rem;
            min-width: 200px;
            cursor: pointer;
        }
        
        select:focus {
            outline: none;
            border-color: #4cc9f0;
            box-shadow: 0 0 0 3px rgba(76, 201, 240, 0.2);
        }
        
        .image-count {
            color: #a0c0ff;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }
        
        .image-card {
            background: rgba(20, 40, 100, 0.3);
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.4s;
            border: 1px solid rgba(100, 150, 255, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .image-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            border-color: rgba(100, 150, 255, 0.3);
        }
        
        .card-image {
            height: 250px;
            overflow: hidden;
            position: relative;
        }
        
        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s;
        }
        
        .image-card:hover .card-image img {
            transform: scale(1.08);
        }
        
        .card-body {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .scores-container {
            flex-grow: 1;
        }
        
        .score-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }
        
        .score-label {
            width: 140px;
            color: #a0c0ff;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .score-value {
            width: 45px;
            text-align: right;
            margin-right: 12px;
            font-weight: bold;
            color: #4cc9f0;
        }
        
        .score-bar-bg {
            flex-grow: 1;
            height: 10px;
            background: rgba(50, 80, 180, 0.3);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .score-bar-fill {
            height: 100%;
            border-radius: 5px;
            background: linear-gradient(90deg, #4361ee, #4cc9f0);
            transition: width 1s ease-out;
        }
        
        .card-footer {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(100, 150, 255, 0.2);
            color: #8899dd;
            font-size: 0.85rem;
        }
        
        .no-images {
            grid-column: 1 / -1;
            text-align: center;
            padding: 80px 20px;
            color: #a0c0ff;
        }
        
        .no-images i {
            font-size: 4rem;
            margin-bottom: 25px;
            color: #4361ee;
            opacity: 0.7;
        }
        
        .no-images p {
            font-size: 1.3rem;
        }
        
        /* æ–‡ä»¶åˆ—è¡¨æ ·å¼ */
        .file-list {
            margin-top: 25px;
            max-height: 250px;
            overflow-y: auto;
            border-radius: 12px;
            background: rgba(20, 40, 100, 0.2);
            padding: 15px;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(30, 60, 150, 0.3);
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 0.95rem;
            transition: all 0.2s;
        }
        
        .file-item:hover {
            background: rgba(30, 60, 150, 0.5);
        }
        
        .file-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 70%;
            color: #c0d0ff;
        }
        
        .file-status {
            color: #4cc9f0;
            font-weight: bold;
        }
        
        /* é¡µè„šæ ·å¼ */
        footer {
            text-align: center;
            padding: 30px;
            color: #8ab4ff;
            font-size: 0.95rem;
            border-top: 1px solid rgba(100, 150, 255, 0.1);
            margin-top: 40px;
        }
        
        footer p {
            margin-bottom: 10px;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .upload-areas {
                grid-template-columns: 1fr;
            }
            
            .dimension-filters {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .upload-areas {
                grid-template-columns: 1fr;
            }
            
            .dimension-filters {
                grid-template-columns: 1fr;
            }
            
            .gallery-controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .image-grid {
                grid-template-columns: 1fr;
            }
            
            .current-filter-info {
                flex-direction: column;
            }
            
            .filter-info-item {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-images"></i> äºŒæ¬¡å…ƒç¾å­¦å›¾ç‰‡è®­ç»ƒé›†ç®¡ç†ç³»ç»Ÿ</h1>
            <p class="subtitle">ä¸Šä¼ å›¾ç‰‡ä¸JSONç¾å­¦è¯„åˆ†ï¼Œå®æ—¶æŸ¥çœ‹å¤šç»´åº¦è¯„åˆ†ï¼ŒæŒ‰ç¾å­¦ç­‰çº§ç­›é€‰å›¾ç‰‡ï¼Œå¹¶ç»Ÿè®¡è¯„åˆ†åˆ†å¸ƒ</p>
        </header>
        
        <!-- ä¸Šä¼ åŒºåŸŸ -->
        <section class="upload-section">
            <h2 class="section-title"><i class="fas fa-cloud-upload-alt"></i> ä¸Šä¼ å›¾ç‰‡ä¸è¯„åˆ†æ•°æ®</h2>
            
            <div class="upload-areas">
                <div class="upload-area" id="imageUploadArea">
                    <i class="fas fa-file-image"></i>
                    <h3>ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶</h3>
                    <p>æ”¯æŒ JPG, PNG, GIF æ ¼å¼</p>
                    <p>å¯å•æ¬¡é€‰æ‹©å¤šå¼ å›¾ç‰‡</p>
                    <p class="file-status" id="imageStatus">ç­‰å¾…ä¸Šä¼ å›¾ç‰‡...</p>
                </div>
                
                <div class="upload-area" id="jsonUploadArea">
                    <i class="fas fa-file-code"></i>
                    <h3>ä¸Šä¼ JSONè¯„åˆ†æ–‡ä»¶</h3>
                    <p>åŒ…å«7ä¸ªç¾å­¦ç»´åº¦çš„è¯„åˆ†</p>
                    <p>æ ¼å¼å¿…é¡»ç¬¦åˆæŒ‡å®šè¦æ±‚</p>
                    <p class="file-status" id="jsonStatus">ç­‰å¾…ä¸Šä¼ JSON...</p>
                </div>
            </div>
            
            <input type="file" id="imageInput" class="file-input" accept=".jpg,.jpeg,.png,.gif" multiple>
            <input type="file" id="jsonInput" class="file-input" accept=".json">
            
            <button id="uploadButton" class="upload-btn" disabled>
                <i class="fas fa-rocket"></i> ä¸Šä¼ å¹¶å¤„ç†å›¾ç‰‡ä¸è¯„åˆ†æ•°æ®
            </button>
            
            <div class="upload-status" id="uploadStatus">
                <p><i class="fas fa-info-circle"></i> è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶å’Œå¯¹åº”çš„JSONè¯„åˆ†æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»ä¸Šä¼ æŒ‰é’®ã€‚</p>
            </div>
            
            <div class="file-list" id="fileList">
                <!-- å·²é€‰æ‹©æ–‡ä»¶åˆ—è¡¨ä¼šåŠ¨æ€æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
            </div>
        </section>
        
        <!-- ç­›é€‰å™¨åŒºåŸŸ -->
        <section class="filter-section">
            <h2 class="section-title"><i class="fas fa-filter"></i> ç¾å­¦ç»´åº¦ç­›é€‰å™¨</h2>
            
            <div class="dimension-filters" id="dimensionFilters">
                <!-- ç»´åº¦ç­›é€‰å™¨ä¼šé€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="current-filter-info">
                <div class="filter-info-item">
                    <div class="filter-info-label">å½“å‰ç­›é€‰ç»´åº¦</div>
                    <div class="filter-info-value" id="currentDimension">å…¨éƒ¨ç»´åº¦</div>
                </div>
                <div class="filter-info-item">
                    <div class="filter-info-label">å½“å‰ç­›é€‰ç­‰çº§</div>
                    <div class="filter-info-value" id="currentLevel">å…¨éƒ¨ç­‰çº§</div>
                </div>
                <div class="filter-info-item">
                    <div class="filter-info-label">ç­›é€‰ç»“æœ</div>
                    <div class="filter-info-value" id="filterCount">0 å¼ å›¾ç‰‡</div>
                </div>
                <div class="filter-info-item">
                    <button id="clearFilterBtn" class="filter-btn" style="margin-top: 10px;">
                        <i class="fas fa-times"></i> æ¸…é™¤ç­›é€‰
                    </button>
                </div>
            </div>
        </section>
        
        <!-- ç»Ÿè®¡åŒºåŸŸ -->
        <section class="stats-section">
            <h2 class="section-title"><i class="fas fa-chart-bar"></i> ç¾å­¦è¯„åˆ†åˆ†å¸ƒç»Ÿè®¡</h2>
            
            <div class="stats-grid" id="statsGrid">
                <!-- ç»Ÿè®¡ä¿¡æ¯ä¼šé€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </section>
        
        <!-- å›¾ç‰‡ç”»å»Š -->
        <section class="gallery-section">
            <div class="gallery-controls">
                <h2 class="section-title"><i class="fas fa-th"></i> å›¾ç‰‡ç¾å­¦è¯„åˆ†ç”»å»Š</h2>
                
                <div class="sort-controls">
                    <select id="sortSelect">
                        <option value="created_at">æŒ‰ä¸Šä¼ æ—¶é—´æ’åº (æœ€æ–°ä¼˜å…ˆ)</option>
                        <option value="overall">æŒ‰ç»¼åˆè¯„åˆ†æ’åº (é«˜åˆ°ä½)</option>
                        <option value="watermark_severity">æŒ‰æ°´å°ç¨‹åº¦æ’åº (é«˜åˆ°ä½)</option>
                        <option value="pose_quality">æŒ‰è‚¢ä½“è´¨é‡æ’åº (é«˜åˆ°ä½)</option>
                        <option value="clarity_score">æŒ‰æ¸…æ™°åº¦æ’åº (é«˜åˆ°ä½)</option>
                        <option value="color_harmony">æŒ‰è‰²å½©å’Œè°åº¦æ’åº (é«˜åˆ°ä½)</option>
                        <option value="composition_balance">æŒ‰æ„å›¾å¹³è¡¡æ€§æ’åº (é«˜åˆ°ä½)</option>
                        <option value="background_quality">æŒ‰èƒŒæ™¯å®Œæˆåº¦æ’åº (é«˜åˆ°ä½)</option>
                        <option value="distraction_level">æŒ‰å¹²æ‰°ç¨‹åº¦æ’åº (é«˜åˆ°ä½)</option>
                    </select>
                    <div class="image-count">å…± <span id="totalImages">0</span> å¼ å›¾ç‰‡</div>
                </div>
            </div>
            
            <div class="image-grid" id="imageGrid">
                <!-- å›¾ç‰‡å¡ç‰‡ä¼šé€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                <div class="no-images" id="noImages">
                    <i class="fas fa-image"></i>
                    <p>æš‚æ— å›¾ç‰‡æ•°æ®ï¼Œè¯·ä¸Šä¼ å›¾ç‰‡å’ŒJSONè¯„åˆ†æ–‡ä»¶</p>
                </div>
            </div>
        </section>
        
        <footer>
            <p>äºŒæ¬¡å…ƒç¾å­¦å›¾ç‰‡è®­ç»ƒé›†ç®¡ç†ç³»ç»Ÿ &copy; 2023 | åŸºäºVercel + Supabaseæ¶æ„</p>
            <p>æç¤ºï¼šæ‰€æœ‰æ•°æ®é€šè¿‡APIå®æ—¶è·å–ï¼Œä¸Šä¼ åè‡ªåŠ¨åŒæ­¥åˆ°äº‘ç«¯æ•°æ®åº“</p>
        </footer>
    </div>

    <!-- JavaScriptä»£ç  -->
    <script>
        // é…ç½®APIç«¯ç‚¹ - è¯·æ›¿æ¢ä¸ºä½ çš„å®é™…Vercelåç«¯APIåœ°å€
        const API_BASE_URL = 'https://your-vercel-app.vercel.app/api'; // ç¤ºä¾‹ï¼šhttps://aesthetic-ratings.vercel.app/api
        
        // ç¾å­¦ç»´åº¦é…ç½®
        const dimensions = [
            {
                id: 'watermark_severity',
                name: 'æ°´å°ä¸¥é‡ç¨‹åº¦',
                description: '0.0=æåº¦ä¸¥é‡æ°´å°ï¼Œ1.0=å®Œå…¨æ— æ°´å°'
            },
            {
                id: 'pose_quality',
                name: 'è‚¢ä½“è¡¨ç°è´¨é‡',
                description: '0.0=ä¸¥é‡å˜å½¢ï¼Œ1.0=å®Œç¾è§£å‰–/æè‡´æµç•…'
            },
            {
                id: 'clarity_score',
                name: 'å›¾åƒæ¸…æ™°åº¦',
                description: '0.0=ä¸¥é‡æ¨¡ç³Š/åƒç´ åŒ–ï¼Œ1.0=è¶…é«˜æ¸…/å®Œç¾ç»†èŠ‚'
            },
            {
                id: 'color_harmony',
                name: 'è‰²å½©å’Œè°åº¦',
                description: '0.0=è‰²å½©å†²çª/åˆºçœ¼ï¼Œ1.0=å®Œç¾è‰²å½©/æƒ…æ„Ÿç²¾å‡†'
            },
            {
                id: 'composition_balance',
                name: 'æ„å›¾å¹³è¡¡æ€§',
                description: '0.0=ä¸¥é‡å¤±è¡¡/è§†è§‰æ··ä¹±ï¼Œ1.0=å®Œç¾æ„å›¾/è‰ºæœ¯å¹³è¡¡'
            },
            {
                id: 'background_quality',
                name: 'èƒŒæ™¯å®Œæˆåº¦',
                description: '0.0=æ— èƒŒæ™¯/çº¯è‰²ï¼Œ1.0=è‰ºæœ¯çº§èƒŒæ™¯/ç»†èŠ‚ä¸°å¯Œ'
            },
            {
                id: 'distraction_level',
                name: 'ç”»é¢å¹²æ‰°ç¨‹åº¦',
                description: '0.0=ä¸¥é‡å¹²æ‰°ï¼Œ1.0=ç”»é¢çº¯å‡€æ— å¹²æ‰°'
            }
        ];
        
        // è¯„åˆ†ç­‰çº§é…ç½®
        const scoreLevels = [
            { min: 0.0, max: 0.2, label: 'æå·® (0.0-0.2)', class: 'poor' },
            { min: 0.2, max: 0.4, label: 'è¾ƒå·® (0.2-0.4)', class: 'fair' },
            { min: 0.4, max: 0.6, label: 'ä¸­ç­‰ (0.4-0.6)', class: 'good' },
            { min: 0.6, max: 0.8, label: 'è‰¯å¥½ (0.6-0.8)', class: 'excellent' },
            { min: 0.8, max: 1.0, label: 'ä¼˜ç§€ (0.8-1.0)', class: 'perfect' }
        ];
        
        // å…¨å±€å˜é‡
        let selectedImages = [];
        let selectedJson = null;
        let imageData = [];
        let currentFilter = {
            dimension: null,
            level: null
        };
        
        // DOMå…ƒç´ 
        const imageUploadArea = document.getElementById('imageUploadArea');
        const jsonUploadArea = document.getElementById('jsonUploadArea');
        const imageInput = document.getElementById('imageInput');
        const jsonInput = document.getElementById('jsonInput');
        const uploadButton = document.getElementById('uploadButton');
        const uploadStatus = document.getElementById('uploadStatus');
        const fileList = document.getElementById('fileList');
        const dimensionFilters = document.getElementById('dimensionFilters');
        const currentDimensionEl = document.getElementById('currentDimension');
        const currentLevelEl = document.getElementById('currentLevel');
        const filterCountEl = document.getElementById('filterCount');
        const clearFilterBtn = document.getElementById('clearFilterBtn');
        const statsGrid = document.getElementById('statsGrid');
        const sortSelect = document.getElementById('sortSelect');
        const totalImagesEl = document.getElementById('totalImages');
        const imageGrid = document.getElementById('imageGrid');
        const noImages = document.getElementById('noImages');
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initUploadAreas();
            renderDimensionFilters();
            updateStats();
            fetchImageData();
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            clearFilterBtn.addEventListener('click', clearFilter);
            sortSelect.addEventListener('change', updateGallery);
        });
        
        // åˆå§‹åŒ–ä¸Šä¼ åŒºåŸŸ
        function initUploadAreas() {
            // å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ
            imageUploadArea.addEventListener('click', () => imageInput.click());
            imageUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                imageUploadArea.style.borderColor = '#4cc9f0';
                imageUploadArea.style.background = 'rgba(30, 60, 150, 0.3)';
            });
            imageUploadArea.addEventListener('dragleave', () => {
                imageUploadArea.style.borderColor = '#4361ee';
                imageUploadArea.style.background = 'rgba(30, 60, 150, 0.15)';
            });
            imageUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                imageUploadArea.style.borderColor = '#4361ee';
                imageUploadArea.style.background = 'rgba(30, 60, 150, 0.15)';
                
                if (e.dataTransfer.files.length) {
                    imageInput.files = e.dataTransfer.files;
                    handleImageSelection();
                }
            });
            
            // JSONä¸Šä¼ åŒºåŸŸ
            jsonUploadArea.addEventListener('click', () => jsonInput.click());
            jsonUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                jsonUploadArea.style.borderColor = '#4cc9f0';
                jsonUploadArea.style.background = 'rgba(30, 60, 150, 0.3)';
            });
            jsonUploadArea.addEventListener('dragleave', () => {
                jsonUploadArea.style.borderColor = '#4361ee';
                jsonUploadArea.style.background = 'rgba(30, 60, 150, 0.15)';
            });
            jsonUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                jsonUploadArea.style.borderColor = '#4361ee';
                jsonUploadArea.style.background = 'rgba(30, 60, 150, 0.15)';
                
                if (e.dataTransfer.files.length) {
                    jsonInput.files = e.dataTransfer.files;
                    handleJsonSelection();
                }
            });
            
            // æ–‡ä»¶è¾“å…¥å˜åŒ–ç›‘å¬
            imageInput.addEventListener('change', handleImageSelection);
            jsonInput.addEventListener('change', handleJsonSelection);
            
            // ä¸Šä¼ æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            uploadButton.addEventListener('click', handleUpload);
        }
        
        // å¤„ç†å›¾ç‰‡é€‰æ‹©
        function handleImageSelection() {
            selectedImages = Array.from(imageInput.files);
            const imageStatus = document.getElementById('imageStatus');
            
            if (selectedImages.length > 0) {
                imageStatus.textContent = `å·²é€‰æ‹© ${selectedImages.length} å¼ å›¾ç‰‡`;
                imageStatus.style.color = '#4cc9f0';
                updateFileList();
                updateUploadButton();
            } else {
                imageStatus.textContent = 'ç­‰å¾…ä¸Šä¼ å›¾ç‰‡...';
                imageStatus.style.color = '';
                updateFileList();
                updateUploadButton();
            }
        }
        
        // å¤„ç†JSONé€‰æ‹©
        function handleJsonSelection() {
            if (jsonInput.files.length > 0) {
                selectedJson = jsonInput.files[0];
                const jsonStatus = document.getElementById('jsonStatus');
                jsonStatus.textContent = `å·²é€‰æ‹©: ${selectedJson.name}`;
                jsonStatus.style.color = '#4cc9f0';
                updateFileList();
                updateUploadButton();
            }
        }
        
        // æ›´æ–°æ–‡ä»¶åˆ—è¡¨æ˜¾ç¤º
        function updateFileList() {
            fileList.innerHTML = '';
            
            // æ˜¾ç¤ºå›¾ç‰‡æ–‡ä»¶
            selectedImages.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-name">ğŸ“· ${file.name} (${(file.size / 1024).toFixed(1)} KB)</div>
                    <div class="file-status">å¾…ä¸Šä¼ </div>
                `;
                fileList.appendChild(fileItem);
            });
            
            // æ˜¾ç¤ºJSONæ–‡ä»¶
            if (selectedJson) {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-name">ğŸ“„ ${selectedJson.name} (${(selectedJson.size / 1024).toFixed(1)} KB)</div>
                    <div class="file-status">å¾…ä¸Šä¼ </div>
                `;
                fileList.appendChild(fileItem);
            }
            
            // å¦‚æœæ²¡æœ‰ä»»ä½•æ–‡ä»¶ï¼Œæ˜¾ç¤ºæç¤º
            if (selectedImages.length === 0 && !selectedJson) {
                fileList.innerHTML = '<div style="text-align: center; color: #8899dd; padding: 20px;">æš‚æ— æ–‡ä»¶è¢«é€‰æ‹©</div>';
            }
        }
        
        // æ›´æ–°ä¸Šä¼ æŒ‰é’®çŠ¶æ€
        function updateUploadButton() {
            if (selectedImages.length > 0 && selectedJson) {
                uploadButton.disabled = false;
                uploadStatus.innerHTML = '<p><i class="fas fa-check-circle" style="color: #4cc9f0;"></i> å·²å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»æŒ‰é’®ä¸Šä¼ å›¾ç‰‡å’Œè¯„åˆ†æ•°æ®ã€‚</p>';
            } else {
                uploadButton.disabled = true;
                if (selectedImages.length === 0 && !selectedJson) {
                    uploadStatus.innerHTML = '<p><i class="fas fa-info-circle"></i> è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶å’Œå¯¹åº”çš„JSONè¯„åˆ†æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»ä¸Šä¼ æŒ‰é’®ã€‚</p>';
                } else if (selectedImages.length === 0) {
                    uploadStatus.innerHTML = '<p><i class="fas fa-exclamation-triangle" style="color: #ffd166;"></i> è¯·é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶ã€‚</p>';
                } else if (!selectedJson) {
                    uploadStatus.innerHTML = '<p><i class="fas fa-exclamation-triangle" style="color: #ffd166;"></i> è¯·é€‰æ‹©å¯¹åº”çš„JSONè¯„åˆ†æ–‡ä»¶ã€‚</p>';
                }
            }
        }
        
        // å¤„ç†ä¸Šä¼ 
        async function handleUpload() {
            if (selectedImages.length === 0 || !selectedJson) return;
            
            // ç¦ç”¨ä¸Šä¼ æŒ‰é’®å¹¶æ˜¾ç¤ºä¸Šä¼ çŠ¶æ€
            uploadButton.disabled = true;
            uploadButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ä¸Šä¼ å¤„ç†ä¸­...';
            uploadStatus.innerHTML = '<p><i class="fas fa-spinner fa-spin"></i> æ­£åœ¨ä¸Šä¼ å¹¶å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</p>';
            
            // æ›´æ–°æ–‡ä»¶åˆ—è¡¨çŠ¶æ€
            const fileItems = fileList.querySelectorAll('.file-item');
            fileItems.forEach(item => {
                const statusDiv = item.querySelector('.file-status');
                if (statusDiv) statusDiv.textContent = 'å¤„ç†ä¸­...';
            });
            
            try {
                // 1. è¯»å–JSONæ–‡ä»¶å†…å®¹
                const jsonText = await readFileAsText(selectedJson);
                let jsonData;
                
                try {
                    jsonData = JSON.parse(jsonText);
                } catch (e) {
                    throw new Error('JSONæ–‡ä»¶æ ¼å¼æ— æ•ˆï¼Œæ— æ³•è§£æ');
                }
                
                // 2. éªŒè¯JSONæ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚
                const requiredFields = [
                    'watermark_severity', 'pose_quality', 'clarity_score',
                    'color_harmony', 'composition_balance', 'background_quality',
                    'distraction_level'
                ];
                
                const missingFields = requiredFields.filter(field => !(field in jsonData));
                if (missingFields.length > 0) {
                    throw new Error(`JSONæ–‡ä»¶ç¼ºå°‘å¿…è¦å­—æ®µ: ${missingFields.join(', ')}`);
                }
                
                // 3. ä¸ºæ¯å¼ å›¾ç‰‡åˆ›å»ºFormDataå¹¶ä¸Šä¼ 
                const uploadPromises = selectedImages.map(async (imageFile, index) => {
                    const formData = new FormData();
                    formData.append('image', imageFile);
                    formData.append('scores', JSON.stringify(jsonData));
                    
                    const response = await fetch(`${API_BASE_URL}/upload`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error(`ä¸Šä¼ å¤±è´¥: ${response.status} ${response.statusText}`);
                    }
                    
                    const result = await response.json();
                    
                    // æ›´æ–°æ–‡ä»¶åˆ—è¡¨çŠ¶æ€
                    if (fileItems[index]) {
                        const statusDiv = fileItems[index].querySelector('.file-status');
                        if (statusDiv) statusDiv.textContent = 'âœ“ å·²å®Œæˆ';
                        if (statusDiv) statusDiv.style.color = '#06d6a0';
                    }
                    
                    return result.data;
                });
                
                // 4. ç­‰å¾…æ‰€æœ‰ä¸Šä¼ å®Œæˆ
                const uploadResults = await Promise.all(uploadPromises);
                
                // 5. æ›´æ–°ç•Œé¢çŠ¶æ€
                uploadButton.innerHTML = '<i class="fas fa-rocket"></i> ä¸Šä¼ å¹¶å¤„ç†å›¾ç‰‡ä¸è¯„åˆ†æ•°æ®';
                uploadStatus.innerHTML = `<p style="color: #06d6a0;"><i class="fas fa-check-circle"></i> æˆåŠŸä¸Šä¼ å¹¶å¤„ç†äº† ${uploadResults.length} å¼ å›¾ç‰‡ï¼æ•°æ®å·²ä¿å­˜åˆ°æ•°æ®åº“ã€‚</p>`;
                
                // 6. æ¸…ç©ºé€‰æ‹©å¹¶åˆ·æ–°æ•°æ®
                selectedImages = [];
                selectedJson = null;
                imageInput.value = '';
                jsonInput.value = '';
                document.getElementById('imageStatus').textContent = 'ç­‰å¾…ä¸Šä¼ å›¾ç‰‡...';
                document.getElementById('jsonStatus').textContent = 'ç­‰å¾…ä¸Šä¼ JSON...';
                document.getElementById('imageStatus').style.color = '';
                document.getElementById('jsonStatus').style.color = '';
                
                updateFileList();
                updateUploadButton();
                
                // 7. é‡æ–°è·å–æ•°æ®å¹¶æ›´æ–°ç•Œé¢
                setTimeout(() => {
                    fetchImageData();
                }, 1000);
                
            } catch (error) {
                console.error('ä¸Šä¼ é”™è¯¯:', error);
                uploadButton.disabled = false;
                uploadButton.innerHTML = '<i class="fas fa-rocket"></i> é‡æ–°å°è¯•ä¸Šä¼ ';
                uploadStatus.innerHTML = `<p style="color: #f72585;"><i class="fas fa-exclamation-triangle"></i> é”™è¯¯: ${error.message}</p>`;
                
                // æ›´æ–°æ–‡ä»¶åˆ—è¡¨çŠ¶æ€ä¸ºå¤±è´¥
                const fileItems = fileList.querySelectorAll('.file-item');
                fileItems.forEach(item => {
                    const statusDiv = item.querySelector('.file-status');
                    if (statusDiv && statusDiv.textContent === 'å¤„ç†ä¸­...') {
                        statusDiv.textContent = 'âœ— å¤±è´¥';
                        statusDiv.style.color = '#f72585';
                    }
                });
            }
        }
        
        // è¯»å–æ–‡ä»¶ä¸ºæ–‡æœ¬
        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = (e) => reject(new Error('æ–‡ä»¶è¯»å–å¤±è´¥'));
                reader.readAsText(file);
            });
        }
        
        // æ¸²æŸ“ç»´åº¦ç­›é€‰å™¨
        function renderDimensionFilters() {
            dimensionFilters.innerHTML = '';
            
            dimensions.forEach(dimension => {
                const filterElement = document.createElement('div');
                filterElement.className = 'dimension-filter';
                
                const dimensionHeader = document.createElement('div');
                dimensionHeader.className = 'dimension-header';
                
                const dimensionName = document.createElement('div');
                dimensionName.className = 'dimension-name';
                dimensionName.textContent = dimension.name;
                dimensionName.title = dimension.description;
                
                dimensionHeader.appendChild(dimensionName);
                filterElement.appendChild(dimensionHeader);
                
                const filterButtons = document.createElement('div');
                filterButtons.className = 'filter-buttons';
                
                // æ·»åŠ "å…¨éƒ¨"æŒ‰é’®
                const allButton = document.createElement('button');
                allButton.className = 'filter-btn';
                allButton.textContent = 'å…¨éƒ¨';
                allButton.dataset.dimension = dimension.id;
                allButton.dataset.min = 0;
                allButton.dataset.max = 1;
                
                allButton.addEventListener('click', () => {
                    // ç§»é™¤å½“å‰ç»´åº¦çš„æ‰€æœ‰æŒ‰é’®çš„activeçŠ¶æ€
                    filterButtons.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // æ¿€æ´»å½“å‰æŒ‰é’®
                    allButton.classList.add('active');
                    
                    // æ¸…é™¤è¯¥ç»´åº¦çš„ç­›é€‰
                    if (currentFilter.dimension === dimension.id) {
                        currentFilter.dimension = null;
                        currentFilter.level = null;
                        updateFilterInfo();
                        updateGallery();
                    }
                });
                
                filterButtons.appendChild(allButton);
                
                // æ·»åŠ å„ç­‰çº§æŒ‰é’®
                scoreLevels.forEach(level => {
                    const button = document.createElement('button');
                    button.className = `filter-btn ${level.class}`;
                    button.textContent = level.label;
                    button.dataset.dimension = dimension.id;
                    button.dataset.min = level.min;
                    button.dataset.max = level.max;
                    
                    button.addEventListener('click', () => {
                        // ç§»é™¤å½“å‰ç»´åº¦çš„æ‰€æœ‰æŒ‰é’®çš„activeçŠ¶æ€
                        filterButtons.querySelectorAll('.filter-btn').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        
                        // æ¿€æ´»å½“å‰æŒ‰é’®
                        button.classList.add('active');
                        
                        // è®¾ç½®å½“å‰ç­›é€‰
                        currentFilter.dimension = dimension.id;
                        currentFilter.level = level;
                        
                        // æ›´æ–°ç­›é€‰ä¿¡æ¯
                        updateFilterInfo();
                        
                        // æ›´æ–°ç”»å»Š
                        updateGallery();
                    });
                    
                    filterButtons.appendChild(button);
                });
                
                filterElement.appendChild(filterButtons);
                dimensionFilters.appendChild(filterElement);
            });
        }
        
        // æ¸…é™¤ç­›é€‰
        function clearFilter() {
            currentFilter.dimension = null;
            currentFilter.level = null;
            
            // ç§»é™¤æ‰€æœ‰ç­›é€‰æŒ‰é’®çš„activeçŠ¶æ€
            document.querySelectorAll('.filter-btn.active').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ¿€æ´»æ‰€æœ‰"å…¨éƒ¨"æŒ‰é’®
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent === 'å…¨éƒ¨') {
                    btn.classList.add('active');
                }
            });
            
            updateFilterInfo();
            updateGallery();
        }
        
        // æ›´æ–°ç­›é€‰ä¿¡æ¯æ˜¾ç¤º
        function updateFilterInfo() {
            if (currentFilter.dimension && currentFilter.level) {
                const dimension = dimensions.find(d => d.id === currentFilter.dimension);
                currentDimensionEl.textContent = dimension.name;
                currentLevelEl.textContent = currentFilter.level.label;
            } else {
                currentDimensionEl.textContent = 'å…¨éƒ¨ç»´åº¦';
                currentLevelEl.textContent = 'å…¨éƒ¨ç­‰çº§';
            }
        }
        
        // ä»APIè·å–å›¾ç‰‡æ•°æ®
        async function fetchImageData() {
            try {
                const response = await fetch(`${API_BASE_URL}/list`);
                if (!response.ok) {
                    throw new Error(`è·å–æ•°æ®å¤±è´¥: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success) {
                    imageData = result.data;
                    
                    // è®¡ç®—æ¯å¼ å›¾ç‰‡çš„ç»¼åˆè¯„åˆ†
                    imageData.forEach(item => {
                        const scores = [
                            item.watermark_severity,
                            item.pose_quality,
                            item.clarity_score,
                            item.color_harmony,
                            item.composition_balance,
                            item.background_quality,
                            item.distraction_level
                        ];
                        
                        const total = scores.reduce((sum, score) => sum + score, 0);
                        item.overallScore = total / scores.length;
                    });
                    
                    // æ›´æ–°ç»Ÿè®¡å’Œç”»å»Š
                    updateStats();
                    updateGallery();
                } else {
                    throw new Error(result.error || 'è·å–æ•°æ®å¤±è´¥');
                }
            } catch (error) {
                console.error('è·å–å›¾ç‰‡æ•°æ®é”™è¯¯:', error);
                imageGrid.innerHTML = `
                    <div class="no-images">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>åŠ è½½æ•°æ®å¤±è´¥: ${error.message}</p>
                        <p style="margin-top: 10px; font-size: 0.9rem;">è¯·æ£€æŸ¥APIè¿æ¥: ${API_BASE_URL}</p>
                    </div>
                `;
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            statsGrid.innerHTML = '';
            
            // ç»Ÿè®¡æ¯ä¸ªè¯„åˆ†åŒºé—´çš„å›¾ç‰‡æ•°é‡ï¼ˆåŸºäºç»¼åˆè¯„åˆ†ï¼‰
            const scoreRanges = [
                { min: 0.0, max: 0.2, label: 'æå·® (0.0-0.2)', color: '#ff6b6b' },
                { min: 0.2, max: 0.4, label: 'è¾ƒå·® (0.2-0.4)', color: '#ffd166' },
                { min: 0.4, max: 0.6, label: 'ä¸­ç­‰ (0.4-0.6)', color: '#06d6a0' },
                { min: 0.6, max: 0.8, label: 'è‰¯å¥½ (0.6-0.8)', color: '#118ab2' },
                { min: 0.8, max: 1.0, label: 'ä¼˜ç§€ (0.8-1.0)', color: '#9d4edd' }
            ];
            
            // è®¡ç®—æœ‰è¯„åˆ†çš„å›¾ç‰‡æ•°é‡
            const imagesWithScores = imageData.filter(img => img.overallScore !== undefined);
            
            if (imagesWithScores.length > 0) {
                const overallScores = imagesWithScores.map(img => img.overallScore);
                
                scoreRanges.forEach(range => {
                    const count = overallScores.filter(score => 
                        score >= range.min && score < range.max
                    ).length;
                    
                    const percentage = imagesWithScores.length > 0 ? 
                        ((count / imagesWithScores.length) * 100).toFixed(1) : 0;
                    
                    const statItem = document.createElement('div');
                    statItem.className = 'stat-item';
                    statItem.style.borderTopColor = range.color;
                    
                    statItem.innerHTML = `
                        <div class="stat-count">${count}</div>
                        <div class="stat-range">${range.label}</div>
                        <div class="stat-percentage">${percentage}%</div>
                    `;
                    
                    statsGrid.appendChild(statItem);
                });
                
                // æ·»åŠ æ€»è®¡ç»Ÿè®¡
                const totalItem = document.createElement('div');
                totalItem.className = 'stat-item';
                totalItem.style.gridColumn = 'span 2';
                totalItem.style.borderTopColor = '#4361ee';
                
                totalItem.innerHTML = `
                    <div class="stat-count">${imageData.length}</div>
                    <div class="stat-range">æ€»å›¾ç‰‡æ•°</div>
                    <div class="stat-percentage">${imagesWithScores.length}å¼ æœ‰è¯„åˆ†</div>
                `;
                
                statsGrid.appendChild(totalItem);
            } else {
                // å¦‚æœæ²¡æœ‰è¯„åˆ†æ•°æ®ï¼Œæ˜¾ç¤ºæç¤º
                for (let i = 0; i < 5; i++) {
                    const statItem = document.createElement('div');
                    statItem.className = 'stat-item';
                    statItem.innerHTML = `
                        <div class="stat-count">0</div>
                        <div class="stat-range">${scoreRanges[i].label}</div>
                        <div class="stat-percentage">0%</div>
                    `;
                    statsGrid.appendChild(statItem);
                }
                
                const totalItem = document.createElement('div');
                totalItem.className = 'stat-item';
                totalItem.style.gridColumn = 'span 2';
                
                totalItem.innerHTML = `
                    <div class="stat-count">0</div>
                    <div class="stat-range">æ€»å›¾ç‰‡æ•°</div>
                    <div class="stat-percentage">0å¼ æœ‰è¯„åˆ†</div>
                `;
                
                statsGrid.appendChild(totalItem);
            }
        }
        
        // æ›´æ–°ç”»å»Šæ˜¾ç¤º
        function updateGallery() {
            const sortBy = sortSelect.value;
            
            // ç­›é€‰å›¾ç‰‡
            let filteredImages = [...imageData];
            
            if (currentFilter.dimension && currentFilter.level) {
                filteredImages = filteredImages.filter(img => {
                    if (!img[currentFilter.dimension]) return false;
                    
                    const score = img[currentFilter.dimension];
                    return score >= currentFilter.level.min && score < currentFilter.level.max;
                });
            }
            
            // æ’åºå›¾ç‰‡
            filteredImages.sort((a, b) => {
                if (sortBy === 'created_at') {
                    return new Date(b.created_at) - new Date(a.created_at);
                } else if (sortBy === 'overall') {
                    return (b.overallScore || 0) - (a.overallScore || 0);
                } else {
                    const scoreA = a[sortBy] || 0;
                    const scoreB = b[sortBy] || 0;
                    return scoreB - scoreA;
                }
            });
            
            // æ›´æ–°è®¡æ•°
            totalImagesEl.textContent = imageData.length;
            filterCountEl.textContent = `${filteredImages.length} å¼ å›¾ç‰‡`;
            
            // å¦‚æœæ²¡æœ‰å›¾ç‰‡ï¼Œæ˜¾ç¤ºæç¤º
            if (filteredImages.length === 0) {
                imageGrid.innerHTML = '';
                noImages.style.display = 'block';
                imageGrid.appendChild(noImages);
                return;
            }
            
            // æ¸…ç©ºç”»å»Š
            imageGrid.innerHTML = '';
            noImages.style.display = 'none';
            
            // æ¸²æŸ“å›¾ç‰‡å¡ç‰‡
            filteredImages.forEach(image => {
                const imageCard = document.createElement('div');
                imageCard.className = 'image-card';
                
                // æ„é€ è¯„åˆ†æ¡HTML
                const scoreBars = dimensions.map(dimension => {
                    const value = image[dimension.id];
                    const label = dimension.name;
                    const percentage = (value * 100).toFixed(0);
                    
                    return `
                        <div class="score-row">
                            <div class="score-label" title="${dimension.description}">${label}</div>
                            <div class="score-value">${value.toFixed(2)}</div>
                            <div class="score-bar-bg">
                                <div class="score-bar-fill" style="width: ${percentage}%"></div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // æ„é€ ç»¼åˆè¯„åˆ†æ˜¾ç¤º
                const overallScore = image.overallScore ? image.overallScore.toFixed(2) : 'N/A';
                const overallPercentage = image.overallScore ? (image.overallScore * 100).toFixed(0) : '0';
                
                // è·å–ä¸Šä¼ æ—¶é—´
                const uploadTime = new Date(image.created_at).toLocaleString('zh-CN');
                
                imageCard.innerHTML = `
                    <div class="card-image">
                        <img src="${image.image_url}" alt="ç¾å­¦è¯„ä¼°å›¾ç‰‡" loading="lazy">
                    </div>
                    <div class="card-body">
                        <div class="scores-container">
                            <div class="score-row" style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid rgba(100, 150, 255, 0.2);">
                                <div class="score-label" style="font-weight: bold; color: #4cc9f0;">ç»¼åˆè¯„åˆ†</div>
                                <div class="score-value" style="font-size: 1.1rem;">${overallScore}</div>
                                <div class="score-bar-bg">
                                    <div class="score-bar-fill" style="width: ${overallPercentage}%"></div>
                                </div>
                            </div>
                            ${scoreBars}
                        </div>
                        <div class="card-footer">
                            <small><i class="far fa-clock"></i> ä¸Šä¼ äº: ${uploadTime}</small>
                        </div>
                    </div>
                `;
                
                imageGrid.appendChild(imageCard);
            });
        }
        
        // é¡µé¢åŠ è½½æ—¶è·å–åˆå§‹æ•°æ®
        fetchImageData();
        
        // æ¯éš”30ç§’è‡ªåŠ¨åˆ·æ–°æ•°æ®
        setInterval(fetchImageData, 30000);
    </script>
</body>
</html>